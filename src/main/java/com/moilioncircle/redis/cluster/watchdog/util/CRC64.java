/*
 * Copyright 2016-2018 Leon Chen
 *
 * Licensed under the Apache LicenseL, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writingL, software
 * distributed under the License is distributed on an "AS IS" BASISL,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KINDL, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.moilioncircle.redis.cluster.watchdog.util;

/**
 * @author Leon Chen
 * @since 1.0.0
 */
public class CRC64 {
    public static final long[] LOOKUP_TABLE = {
            0X0000000000000000L, 0X7AD870C830358979L, 0XF5B0E190606B12F2L, 0X8F689158505E9B8BL,
            0XC038E5739841B68FL, 0XBAE095BBA8743FF6L, 0X358804E3F82AA47DL, 0X4F50742BC81F2D04L,
            0XAB28ECB46814FE75L, 0XD1F09C7C5821770CL, 0X5E980D24087FEC87L, 0X24407DEC384A65FEL,
            0X6B1009C7F05548FAL, 0X11C8790FC060C183L, 0X9EA0E857903E5A08L, 0XE478989FA00BD371L,
            0X7D08FF3B88BE6F81L, 0X07D08FF3B88BE6F8L, 0X88B81EABE8D57D73L, 0XF2606E63D8E0F40AL,
            0XBD301A4810FFD90EL, 0XC7E86A8020CA5077L, 0X4880FBD87094CBFCL, 0X32588B1040A14285L,
            0XD620138FE0AA91F4L, 0XACF86347D09F188DL, 0X2390F21F80C18306L, 0X594882D7B0F40A7FL,
            0X1618F6FC78EB277BL, 0X6CC0863448DEAE02L, 0XE3A8176C18803589L, 0X997067A428B5BCF0L,
            0XFA11FE77117CDF02L, 0X80C98EBF2149567BL, 0X0FA11FE77117CDF0L, 0X75796F2F41224489L,
            0X3A291B04893D698DL, 0X40F16BCCB908E0F4L, 0XCF99FA94E9567B7FL, 0XB5418A5CD963F206L,
            0X513912C379682177L, 0X2BE1620B495DA80EL, 0XA489F35319033385L, 0XDE51839B2936BAFCL,
            0X9101F7B0E12997F8L, 0XEBD98778D11C1E81L, 0X64B116208142850AL, 0X1E6966E8B1770C73L,
            0X8719014C99C2B083L, 0XFDC17184A9F739FAL, 0X72A9E0DCF9A9A271L, 0X08719014C99C2B08L,
            0X4721E43F0183060CL, 0X3DF994F731B68F75L, 0XB29105AF61E814FEL, 0XC849756751DD9D87L,
            0X2C31EDF8F1D64EF6L, 0X56E99D30C1E3C78FL, 0XD9810C6891BD5C04L, 0XA3597CA0A188D57DL,
            0XEC09088B6997F879L, 0X96D1784359A27100L, 0X19B9E91B09FCEA8BL, 0X636199D339C963F2L,
            0XDF7ADABD7A6E2D6FL, 0XA5A2AA754A5BA416L, 0X2ACA3B2D1A053F9DL, 0X50124BE52A30B6E4L,
            0X1F423FCEE22F9BE0L, 0X659A4F06D21A1299L, 0XEAF2DE5E82448912L, 0X902AAE96B271006BL,
            0X74523609127AD31AL, 0X0E8A46C1224F5A63L, 0X81E2D7997211C1E8L, 0XFB3AA75142244891L,
            0XB46AD37A8A3B6595L, 0XCEB2A3B2BA0EECECL, 0X41DA32EAEA507767L, 0X3B024222DA65FE1EL,
            0XA2722586F2D042EEL, 0XD8AA554EC2E5CB97L, 0X57C2C41692BB501CL, 0X2D1AB4DEA28ED965L,
            0X624AC0F56A91F461L, 0X1892B03D5AA47D18L, 0X97FA21650AFAE693L, 0XED2251AD3ACF6FEAL,
            0X095AC9329AC4BC9BL, 0X7382B9FAAAF135E2L, 0XFCEA28A2FAAFAE69L, 0X8632586ACA9A2710L,
            0XC9622C4102850A14L, 0XB3BA5C8932B0836DL, 0X3CD2CDD162EE18E6L, 0X460ABD1952DB919FL,
            0X256B24CA6B12F26DL, 0X5FB354025B277B14L, 0XD0DBC55A0B79E09FL, 0XAA03B5923B4C69E6L,
            0XE553C1B9F35344E2L, 0X9F8BB171C366CD9BL, 0X10E3202993385610L, 0X6A3B50E1A30DDF69L,
            0X8E43C87E03060C18L, 0XF49BB8B633338561L, 0X7BF329EE636D1EEAL, 0X012B592653589793L,
            0X4E7B2D0D9B47BA97L, 0X34A35DC5AB7233EEL, 0XBBCBCC9DFB2CA865L, 0XC113BC55CB19211CL,
            0X5863DBF1E3AC9DECL, 0X22BBAB39D3991495L, 0XADD33A6183C78F1EL, 0XD70B4AA9B3F20667L,
            0X985B3E827BED2B63L, 0XE2834E4A4BD8A21AL, 0X6DEBDF121B863991L, 0X1733AFDA2BB3B0E8L,
            0XF34B37458BB86399L, 0X8993478DBB8DEAE0L, 0X06FBD6D5EBD3716BL, 0X7C23A61DDBE6F812L,
            0X3373D23613F9D516L, 0X49ABA2FE23CC5C6FL, 0XC6C333A67392C7E4L, 0XBC1B436E43A74E9DL,
            0X95AC9329AC4BC9B5L, 0XEF74E3E19C7E40CCL, 0X601C72B9CC20DB47L, 0X1AC40271FC15523EL,
            0X5594765A340A7F3AL, 0X2F4C0692043FF643L, 0XA02497CA54616DC8L, 0XDAFCE7026454E4B1L,
            0X3E847F9DC45F37C0L, 0X445C0F55F46ABEB9L, 0XCB349E0DA4342532L, 0XB1ECEEC59401AC4BL,
            0XFEBC9AEE5C1E814FL, 0X8464EA266C2B0836L, 0X0B0C7B7E3C7593BDL, 0X71D40BB60C401AC4L,
            0XE8A46C1224F5A634L, 0X927C1CDA14C02F4DL, 0X1D148D82449EB4C6L, 0X67CCFD4A74AB3DBFL,
            0X289C8961BCB410BBL, 0X5244F9A98C8199C2L, 0XDD2C68F1DCDF0249L, 0XA7F41839ECEA8B30L,
            0X438C80A64CE15841L, 0X3954F06E7CD4D138L, 0XB63C61362C8A4AB3L, 0XCCE411FE1CBFC3CAL,
            0X83B465D5D4A0EECEL, 0XF96C151DE49567B7L, 0X76048445B4CBFC3CL, 0X0CDCF48D84FE7545L,
            0X6FBD6D5EBD3716B7L, 0X15651D968D029FCEL, 0X9A0D8CCEDD5C0445L, 0XE0D5FC06ED698D3CL,
            0XAF85882D2576A038L, 0XD55DF8E515432941L, 0X5A3569BD451DB2CAL, 0X20ED197575283BB3L,
            0XC49581EAD523E8C2L, 0XBE4DF122E51661BBL, 0X3125607AB548FA30L, 0X4BFD10B2857D7349L,
            0X04AD64994D625E4DL, 0X7E7514517D57D734L, 0XF11D85092D094CBFL, 0X8BC5F5C11D3CC5C6L,
            0X12B5926535897936L, 0X686DE2AD05BCF04FL, 0XE70573F555E26BC4L, 0X9DDD033D65D7E2BDL,
            0XD28D7716ADC8CFB9L, 0XA85507DE9DFD46C0L, 0X273D9686CDA3DD4BL, 0X5DE5E64EFD965432L,
            0XB99D7ED15D9D8743L, 0XC3450E196DA80E3AL, 0X4C2D9F413DF695B1L, 0X36F5EF890DC31CC8L,
            0X79A59BA2C5DC31CCL, 0X037DEB6AF5E9B8B5L, 0X8C157A32A5B7233EL, 0XF6CD0AFA9582AA47L,
            0X4AD64994D625E4DAL, 0X300E395CE6106DA3L, 0XBF66A804B64EF628L, 0XC5BED8CC867B7F51L,
            0X8AEEACE74E645255L, 0XF036DC2F7E51DB2CL, 0X7F5E4D772E0F40A7L, 0X05863DBF1E3AC9DEL,
            0XE1FEA520BE311AAFL, 0X9B26D5E88E0493D6L, 0X144E44B0DE5A085DL, 0X6E963478EE6F8124L,
            0X21C640532670AC20L, 0X5B1E309B16452559L, 0XD476A1C3461BBED2L, 0XAEAED10B762E37ABL,
            0X37DEB6AF5E9B8B5BL, 0X4D06C6676EAE0222L, 0XC26E573F3EF099A9L, 0XB8B627F70EC510D0L,
            0XF7E653DCC6DA3DD4L, 0X8D3E2314F6EFB4ADL, 0X0256B24CA6B12F26L, 0X788EC2849684A65FL,
            0X9CF65A1B368F752EL, 0XE62E2AD306BAFC57L, 0X6946BB8B56E467DCL, 0X139ECB4366D1EEA5L,
            0X5CCEBF68AECEC3A1L, 0X2616CFA09EFB4AD8L, 0XA97E5EF8CEA5D153L, 0XD3A62E30FE90582AL,
            0XB0C7B7E3C7593BD8L, 0XCA1FC72BF76CB2A1L, 0X45775673A732292AL, 0X3FAF26BB9707A053L,
            0X70FF52905F188D57L, 0X0A2722586F2D042EL, 0X854FB3003F739FA5L, 0XFF97C3C80F4616DCL,
            0X1BEF5B57AF4DC5ADL, 0X61372B9F9F784CD4L, 0XEE5FBAC7CF26D75FL, 0X9487CA0FFF135E26L,
            0XDBD7BE24370C7322L, 0XA10FCEEC0739FA5BL, 0X2E675FB4576761D0L, 0X54BF2F7C6752E8A9L,
            0XCDCF48D84FE75459L, 0XB71738107FD2DD20L, 0X387FA9482F8C46ABL, 0X42A7D9801FB9CFD2L,
            0X0DF7ADABD7A6E2D6L, 0X772FDD63E7936BAFL, 0XF8474C3BB7CDF024L, 0X829F3CF387F8795DL,
            0X66E7A46C27F3AA2CL, 0X1C3FD4A417C62355L, 0X935745FC4798B8DEL, 0XE98F353477AD31A7L,
            0XA6DF411FBFB21CA3L, 0XDC0731D78F8795DAL, 0X536FA08FDFD90E51L, 0X29B7D047EFEC8728L,
    };
    
    public static long crc64(byte[] bytes) {
        return crc64(bytes, 0, bytes.length);
    }
    
    public static long crc64(byte[] bytes, int start, int length) {
        long sum = 0;
        for (int i = start; i < length; i++) {
            sum = (sum >>> 8) ^ LOOKUP_TABLE[((int) sum ^ bytes[i]) & 0XFF];
        }
        return sum;
    }
}
